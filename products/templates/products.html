{% extends "base.html" %}
{% block content %}

<div id = "productmenu">
    
{% load mptt_tags %}
        <ul>
            {% for parent.category in categories %}
                <li>
                   {{ node.name}}</a>
                {% if not node.is_leaf_node %}
                    <ul class="children">
                        <a href="{% url 'category_detail' id=node.id %}">
                  {{ children | lower}}</a>
                    </ul>
                {% endif %}
             </li>
           {% endfor %}
    </ul>



    <form action="{% url 'search'%}" method="get">
           
            <input type="text" name="q">
            
            <button type="submit">Search</button>
            
            
    </form>
</div><!--End of Product Menu -->

        {% for product in products  %}

        <div class = "col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-6 col-md-4 display panel panel-default">
           
            <div class = "panel-body">
                <div class = "product" style ="background-image: url('{{MEDIA_URL}}{{product.image}}')"></div>
                <a href = "{% url 'product_details' product.id %}">
                <h3>{{product.name}}</h3>
                </a>
                <p class = "product-description">{{product.description}}</p>
                <p>â‚¬{{product.price}}</p>
                
                <p>Average Rating: {{ product.ratings.get.average|floatformat:"1" }} /5 <span class="glyphicon glyphicon-star"></span></p>

                
                <form method="post" action="{% url 'add_to_cart' product.id %}">
                            {% csrf_token %}
                            <div class = "input-group">
                                <input name = "quantity" type = "number" min="1" max = "999" class = "form-control" placeholder  "Quantity">
                                <span class = "input-group-btn">
                                    <button class = "btn btn-success" type = "submit">Add</button>
                                </span>
                            </div>
                </form>
                
            </div>
           
           </div>
           
           
        {% endfor %}
    
{% endblock %}